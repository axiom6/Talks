<!doctype html>
<html lang="en">

<head>
    <title>Getting to Know Scala for Data Science</title>
    <meta charset="utf-8">
    <meta name="description" content="Reactive Principles in Data Science">
    <meta name="author" content="Tom Flaherty">
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <link rel="stylesheet" href="../../lib/bower_components/reveal.js/css/reveal.css">
    <link rel="stylesheet" href="../../lib/bower_components/reveal.js/css/theme/night.css" data-id="theme">
    <link rel="stylesheet" href="../../lib/css/talk.css">
    <link rel="stylesheet" href="../../lib/css/scala-zen.css">

    <script src="../../lib/bower_components/jquery/dist/jquery.js"></script>
    <script src="../../lib/bower_components/reveal.js/lib/js/head.min.js"></script>
    <script src="../../lib/bower_components/reveal.js/js/reveal.js"></script>
    <script src="../../lib/js/RevealInit.js"></script>
    <!--script src="ASCIIMathML.js"></script>
    <script>mathcolor="yellow"</script-->

</head>

<body>

<div class="reveal">

<div class="slides"  style="color:wheat;">

<section data-id="ScalaDBTitle" class="Title">
  <h1 style="font-size:2.5em;">Getting to Know Scala</h1>
  <h1 style="font-size:2.5em;">for Data Science</h1>
  <a  style="font-size:2.0em;" href="http://twitter.com/TheTomFlaherty">@TheTomFlaherty</a>
</section>

<section data-id="Bio" class="Abstract">
  <h2 style="text-align:left;">Bio:</h2>
  <p>I have been a Chief Architect for 20 years, where he first become enamored by Scala in 2006.
    Over the years I have written a symbolic math application in Scala at Glaxo in 2008 for molecular dynamics
    and in 2010 I formed the Front Range Polyglot Panel and participated as its Scala expert.</p>
  <!--h3 style="text-align:left;">The Real Bio:</h3>
  <p>In the past I enjoyed living in the twilight zone between Data Science and programming where no one bothered me,
    but recently I have realized that Data Science is engaging warp drive and I want to be Captain Kirk.</p-->
</section>

<section data-id="ScalaDBAbstract1" class="Abstract">
  <h2>Abstract</h2>
  <ul>
    <li class="FontSize36px">Scala has gained a lot of traction recently,</li>
    <li class="FontSize36px">Especially in Data Science with:
    <ul>
      <li>Spark</li>
      <li>Cassandra with Spark Connector</li>
      <li>Kafka</li>
    </ul>
  </ul>
</section>

<section data-id="Success Factor" class="Abstract" >
  <h3>So what are Scala's success factors for Data Science?</h3>
  <ul>
    <li>A Strong Affinity to Data</li>
    <li>Functional Programmming with Streaming
      <ul>
        <li>That is Capable of Mirroring Math Syntax</li>
        <li>But only if programmers strive for it</li>
     </ul>
    <li>Awesome Concurrency under the Covers</li>
    <li>The Spark Ecosystem</li>
    <li>A vibrant Open Source comminity around Typesafe and Spark</li>
  </ul>
</section>


<section data-id="Outline">
  <h4>Outline</h4>
  <div style="position:relative;   left:0; top:0; width:100%; height:700px; font-size:22px;">
    <div style="position:absolute; left:0; top:0; width: 40%; height:100%; ">
      <ul>
        <li>Introduction to Scala
          <ul>
            <li>About</li>
            <li>Class  Declarations</li>
            <li>Functions</li>
            <li>Processing Collections</li>
            <li>Methods on Collections</li>
            <li>For Comprehensions</li>
          </ul>
        </li>
        <li>What Data Likes:
          <ul>
            <li>To Be a First Class Citizen</li>
            <li>To Assert Its Identity</li>
            <li>To Remain Intact</li>
            <li>Pattern Matching
              <ul>
                <li>Revealing Data</li>
                <li>Sharing Contents</li>
                <li>Derivative</li>
              </ul>
          </ul>
        </li>
      </ul>
    </div>
    <div style="position:absolute; left:40%; top:0; width:60%;  height:100%; ">
      <ul>
        <li>What do Data Scientist Like
          <ul>
            <li>A Universal Data Representation</li>
            <li>To Simulate Things All at Once</li>
            <li>Data Driven Results</li>
            <li>To Orchestrate Processing</li>
          </ul>
        </li>
        <li>Spark
          <ul>
            <li>Architecure</li>
            <li>RDD Resilient Distributed Data</li>
            <li>RDD Workflow</li>
            <li>Processing Steps</li>
          </ul>
        <li>Orchestrations
          <ul>
            <li>Word Count</li>
            <li>Machine Learning</li>
            <li>Kafka Spark Cassandra</li>
            <li>Grand Finale</li>
          </ul>
        </li>
        <li>References</li>
      </ul>
    </div>
  </div>
</section>

<section data-id="">
  <h1>Introduction</h1>
</section>

<section data-id="">
  <h2>About Scala</h2>
  <ul>
    <li>State of the Art Class Hierarchy + Functional Programming</li>
    <li>Fully Leverages the JVM
      <ul>
        <li>Concurrency from Doug Lea</li>
        <li>JIT (Just IN Time) inlines functional constructs</li>
        <li>Comparable in speed to Java &plusmn;3%</li>
      </ul>
    </li>
    <li>Interoperates with Java
      <ul>
        <li>Can use any Java class (inherit from, etc.)</li>
        <li>Can be called from Java</li>
      </ul>
    </li>
    <li> Statically Typed
      <ul>
        <li>Type inference</li>
      </ul>
    </li>
  </ul>
</section>


<section data-id="">
  <h2>Class and object Declarations</h2>
<pre class="scala"><code style="font-size:1em; min-height:24em;  min-width:44em; border:1px solid white;">
  // [T] is a parameterized type for typing the contents with a class
  // You can parameterize a class with many types [T,U,V]
  // You can embed parameterized types [Key,List[T]]
  trait          Trait[T]{...}
  abstract class Abs[T](       i:Int ) extends Trait[T]{...}
  class          Concrete[T](  i:Int ) extends Abs[T]( i:Int) {...}
  case class     Case[T](      i:Int )
  class          Composite[T]( i:Int ) extends Abs[T]( i:Int)
    with Trait1[T] with Trait2[T] {...}
  </code></pre>
</section>

<section data-id="">
  <h2>Functions</h2>
  <pre class="scala"><code style="font-size:1em; min-height:24em;  min-width:40em; border:1px solid white;">
    ( x:Int ) => x + 2 // full version
    x         => x + 2 // type inferred
    _ + 2              // placeholder syntax
    def addTwo( x:Int ) : Int = x + 2 // Regular Function
  </code></pre>
</section>


<section data-id="">
  <h2>Processing a List Collection</h2>
<pre class="scala"><code style="font-size:1em; min-height:24em;  min-width:40em; border:1px solid white;">
val list = List(1, 2, 3)        // Scala infers an immutable List[Int]
list.foreach( x => println(x) ) // prints 1, 2, 3
list.foreach( println )         // same
list.map( x => x + 2 )          // returns a new List(3, 4, 5)
list.map( _ + 2 )               // same
list.filter( x => x % 2 == 1)   // returns a new List(1, 3)
list.filter( _ % 2 == 1 )       // same
list.reduce( (x,y) => x + y )   // => 6
list.reduce( _ + _ )            // Placeholder syntax
 // Be expressive self documenting - Use placeholder syntax judiciously
</code></pre>
</section>

<section data-id="">
  <h3>Functional Methods on Seq[T] Collections</h3>
  <table>
    <tr><th>Method on Seq[T]</th><th>Description</th></tr>
    <tr><td><pre class="scala">map(     f:T => U       ) : Seq[U]</pre></td><td>Each element is result of f</td></tr>
    <tr><td><pre class="scala">flatMap( f:T => Seq[U]  ) : Seq[U]</pre></td><td>f returns a seq for each element that are flatten into result</td></tr>
    <tr><td><pre class="scala">filter(  f:T => Boolean ) : Seq[T]</pre></td><td>Keep only elements where f is true</td></tr>
    <tr><td><pre class="scala">exists(  f:T => Boolean ) : Boolean</pre></td><td>True if one element passes f</td></tr>
    <tr><td><pre class="scala">forall(  f:T => Boolean ) : Boolean</pre></td><td>True if all elements pass  f</td></tr>
    <tr><td><pre class="scala">groupBy( f:T => Key     ) : Map[Key,Seq[T]]</pre></td><td>Group elements into a Key Seq Map</td></tr>
    <tr><td><pre class="scala">reduce(  f:(T,T) => T   ) : T</pre></td><td>Summarize elements using an f with two arg</td></tr>
    <tr><td><pre class="scala">....</pre></td><td>... many more methods</td></tr>
  </table>
</section>

<section data-id="">
  <h2>For Comprehensions</h2>
  <pre class="scala"><code style="font-size:1em; min-height:24em;  min-width:40em; border:1px solid white;">
  </code></pre>
</section>

<section data-id="ScalaDBAbstract2" class="Abstract">
  <h3>Let's Ask Data What It Likes:</h3>
  <table>
    <tr><th>Data Likes</th><th>Scala Feature</th></tr>
    <tr><td>Being a First Class Citizen</td><td>Primitives As Classes</td></tr>
    <tr><td>To Assert its Identity</td><td>Strong Typing</td></tr>
    <tr><td>To Stay Intact</td><td>Immutability</td></tr>
    <tr><td>To Reveal Its Contents</td><td>Pattern Matching</td></tr>
    <tr><td>To Share its Contents</td><td>Case Classes</td></tr>
    <tr><td>Resilient Packaging</td><td>Monads</td></tr>
  </table>
</section>


<section data-id="">
  <h3>Data is First Class Citizen</h3>
  <h3>with Scala's Class Hierarchy</h3>
<pre class="scala"><code style="font-size:1em; min-height:24em;  min-width:44em; border:1px solid white;">
Any
  AnyVal           // Scala's base class for Java primitives and Unit
    Double Float Long Int Short Char Byte Boolean Unit
  scala.Array      // compiles to Java arrays [] most of the time
  AnyRef           // compiles to java.lang.Object
    String         // compiles to java.lang.String
    (all other Java Classes ...)
    scala.ScalaObject
      (all other Scala Classes ...)
      scala.Seq    // base Class for all ordered collections

      scala.List   // Immutable list for pattern matching
      scala.Option // Yields to Some(value) or None
    scala.Null     // is a subtype for all AnyRef classes
                   // For Java compatibility. Better to use Option
  scala.Nothing    // is a subtype of all Any classes. A true empty value

  5.toString() is valid because 5 is an object
</code></pre>
</section>

<section data-id="">
  <h2>Asserting Identity with Types</h2>
  <pre class="scala"><code style="font-size:1em; min-height:24em;  min-width:40em; border:1px solid white;">
  </code></pre>
</section>

<section data-id="">
  <h2>Staying Intact - Immutability</h2>
  <pre class="scala"><code style="font-size:1em; min-height:24em;  min-width:40em; border:1px solid white;">
  </code></pre>
</section>



<section data-id="">
  <h2>Revealing Contents</h2>
</section>

  <section data-id="">
    <h2>Sharing Contents</h2>
    <h3>OO Encapsulation Got it All Wrong</h3>
  </section>

  <section data-id="">
  <h1>Pattern Matching</h1>
  <h2>with Case Classes</h2>
</section>


<section data-id="">
  <h3>Message Interogation using</h3>
  <h3>Pattern Matching with Scala Actors</h3>
<pre class="scala"><code style="font-size:1em; min-height:24em;  min-width:40em; border:1px solid white;">
</code></pre>
</section>

<section data-id="ScalaDBAbstract2" class="Abstract">
  <h3>What Do Data Scientists Like?</h3>
  <table class="FontSize28px">
    <tr><th>Scientists Like</th><th>Spark Feature</th></tr>
    <tr><td>A Universal Data Representation</td><td>RDD Resilent Distributed Data</td></tr>
    <tr><td>To Simulate Things All at Once</td><td>Concurrency</td></tr>
    <tr><td>Data Driven Results</td><td>Pattern Matching</td></tr>
    <tr><td>To Orchestrate Processing</td><td>Streams</td></tr>
  </table>
</section>

<section data-id="">
  <div   style="position:absolute; left: 0;   top: 0;  width:960px; height:700px; color:white;">
    <div style="position:absolute; left: 0;   top:12%; width:100%;  height:10%;    background-color:blue;  border-radius:16px; font-size:36pt;">Your Code</div>
    <div style="position:absolute; left: 0;   top:24%; width:100%;  height:10%;    background-color:blue;  border-radius:16px; font-size:36pt;">Spark Streaming of RDDs</div>
    <div style="position:absolute; left: 0;   top:36%; width:100%;  height:10%;    background-color:blue;  border-radius:16px;;"><img src="../img/logo/AkkaLogo.png" height="72" style=" border:none;"></div>
 <!--div style="position:absolute; left:13%;  top:46%; width:  4%;  height:28%;    background-color:blue;  z-index:2;"></div>
    <div style="position:absolute; left:48%;  top:46%; width:  4%;  height:28%;    background-color:blue;  z-index:2;"></div>
    <div style="position:absolute; left:83%;  top:46%; width:  4%;  height:28%;    background-color:blue;  z-index:2;"></div-->
    <div style="position:absolute; left: 0;   top:49%; width: 30%;  height:25%;    background-color:steelblue;"></div>
    <div style="position:absolute; left: 0;   top:74%; width: 30%;  height:25%;    background-color:steelblue;"><img src="../img/logo/KafkaLogo.png" width="288" height="175"  style=" border:none;"></div>
    <div style="position:absolute; left:35%;  top:49%; width: 30%;  height:25%;    background-color:#FFFF99;"></div>
    <div style="position:absolute; left:35%;  top:74%; width: 30%;  height:25%;    background-color:goldenrod;"><img src="../img/logo/MLlibLogo2.png" width="288" height="175"></div>
    <div style="position:absolute; left:70%;  top:49%; width: 30%;  height:25%;    background-color:#FF9999;"></div>
    <div style="position:absolute; left:70%;  top:74%; width: 30%;  height:25%;    background-color:sienna;"><img src="../img/logo/CassandraLogo2.png" width="288" height="175"></div>
  </div>
</section>



<section data-id="">
  <h2>RDD Resilient Distributed Data</h2>
  <div>Internally, each RDD is characterized by five main properties:

    A list of partitions
    A function for computing each split
    A list of dependencies on other RDDs
    Optionally, a Partitioner for key-value RDDs (e.g. to say that the RDD is hash-partitioned)
    Optionally, a list of preferred locations to compute each split on (e.g. block locations for an HDFS file)</div>
</section>

  <section data-id="">
    <h2>RDD Workflow</h2>
    <img src="../img/spark/RDDWorkflow.png">
  </section>

<section data-id="">
  <h2>Transformations</h2>
  <ul>
    <li>Create a new dataset from an existing one</li>
    <li>All transformations in Spark are lazy
      <ul>
        <li>They do not compute their results right away</li>
        <li>Instead they remember the applied transformations</li>
      </ul>
    </li>
    <li>In Order To
      <ul>
        <li>optimize the required calculations</li>
        <li>recover from lost data partitions</li>
      </ul>
    </li>
  </ul>
</section>

  <section data-id="ScalaDBAbstract2" class="Abstract">
    <h3>Transformation Methods</h3>
  <pre class="scala"><code style="font-size:1em; min-height:24em;  min-width:40em; border:1px solid white;">
  def map[U](     f:(T) => U       ) : RDD[U]
  def flatMap[U]( f:(T) => Seq[U]  ) : RDD[U]
  def filter(     f:(T) => Boolean ) : RDD[T]

  def keyBy[K](   f:(T) => K ) : RDD[(K,T)]
  def groupBy[K]( f:(T) => K ) : RDD[(K,Seq[T])]
  def sortBy[K](  f:(T) => K ) : RDD[T]

  def glom(                    ) : RDD[T]
  def distinct(                ) : RDD[T]
  def intersection( rdd:RDD[T] ) : RDD[T]
  def subtract(     rdd:RDD[T] ) : RDD[T]
  def union(        rdd:RDD[T] ) : RDD[T]
  def cartesian[U]( rdd:RDD[U] ) : RDD[(T,U)]
  def zip[U](       rdd:RDD[U] ) : RDD[(T,U))

  def sample( r:Boolean, f:Double, s:Long ): RDD[T]
  def pipe(command: String): RDD[String]
  </code></pre>
  </section>

  <section data-id="ScalaDBAbstract2" class="Abstract">
    <h3>Transformation By Key Value</h3>
      <pre class="scala"><code style="font-size:1em; min-height:24em;  min-width:42em; border:1px solid white;">
  // RDD[K,V]
  def groupByKey(                  ) : RDD[(K,Seq[V])]
  def reduceByKey(    f:(V,V) => V ) : RDD[(K,V)]
  def foldByKey(z:V)( f:(V,V) => V ) : RDD[(K,V)]
  def aggregateByKey[U](z:U)( s:(U,V)=>U, c:(U,U)=>U)] : RDD[(K,U)]
        
  def join[U](    rdd:RDD[(K,U)] ): RDD[(K,(V,U))]   //groupWith
  def cogroup[U]( rdd:RDD[(K,U)] ): RDD[(K,(Seq[V],Seq[U]))]

  def countApproxDistinctByKey(relativeSD: Double): RDD[(K, Long)
  def flatMapValues[U](f: (V) => TraversableOnce[U]): RDD[(K, U)]

  type Opt[X] = Option[X]
  def fullOuterJoin[U](  rdd:RDD[(K,U)  ] : RDD[(K,(Opt[V], Opt[U]))]
  def leftOuterJoin[U](  rdd:RDD[(K,U)] ) : RDD[(K,(V,      Opt[U]))]
  def rightOuterJoin[U]( rdd:RDD[(K,U)] ) : RDD[(K,(Opt[V], U     ))]

  def keys: RDD[K]
  def mapValues[U](f: (V) => U ): RDD[(K,U)]
  def sampleByKey( r:Boolean, f:Map[K,Double], s:Long ): RDD[(K,V)]
    </code></pre>
  </section>

  <section data-id="ScalaDBAbstract2" class="Abstract">
    <h3>Action Methods</h3>
  <pre class="scala"><code style="font-size:1em; min-height:24em;  min-width:40em; border:1px solid white;">
    def reduce(    f:(T,T) => T ) : T
    def fold(z:T)( f:(T,T) => T ) : T
    def min()                     : T
    def max()                     : T
    def first()                   : T

    def count()       : Long
    def countByKey()  : Map[K,Long]

    def collect(           ) : Array[T]
    def top(         n:Int ) : Array[T]
    def take(        n:Int ) : Array[T]
    def takeOrdered( n:Int ) : Array[T]
    def takeSample( r:Boolean, n:Int, s:Long ) : Array[T]

    def foreach( f:(T) => Unit ) : Unit // For side effects
  </code></pre>
  </section>

  <section data-id="ScalaDBAbstract2" class="Abstract">
    <h3>MiscMethods</h3>
  <pre class="scala"><code style="font-size:0.9em; min-height:24em;  min-width:42em; border:1px solid white;">
  def mapPartitions()
  def coalesce( numPartitions: Int, shuffle: Boolean ) : RDD[T]
  def aggregate[U](     z:U )( seqOp:(U,T)=>U, combOp:(U U)=>U ) )        : U
  def treeAggregate[U]( z:U )( seqOp:(U,T)=>U, combOp:(U,U)=>U, dep:Int ) : U
  def combineByKey[C]( cc:(V)=>C, mv:(C,V)=>C, mc:(C,C)=>C): RDD[(K,C)]
  def cache() : RDD[T]
  def checkpoint : Unit
  def isEmpty()  : Boolean
  def randomSplit( weights:Array[Double], seed:Long ): Array[RDD[T]]
  </code></pre>
  </section>

  <section data-id="ScalaDBAbstract2" class="Abstract">
    <h3>Save Methods</h3>
  <pre class="scala"><code style="font-size:1em; min-height:24em;  min-width:40em; border:1px solid white;">
    saveAsTextFile
    saveAsSequenceFile
    saveAsObjectFile
  </code></pre>
  </section>




  <section data-id="">
    <h2>Processing Steps</h2>
  </section>

  <section data-id="">
    <h3>Data Driven Results</h3>
    <h3>Pattern Matching</h3>
  </section>








<section data-id="">
  <h1>Orchestration</h1>
</section>

<section data-id="">
  <h2>Word Count</h2>
<pre class="scala"><code style="font-size:1em; min-height:24em;  min-width:40em; border:1px solid white;">
  val f = sc.textFile("README.md")!
  val wc = f.flatMap(l => l.split(" ")).map(word => (word, 1)).reduceByKey(_ + _)!
  wc.saveAsTextFile("wc_out")
</code></pre>
</section>


<section data-id="">
  <h2>Machine Learning</h2>
<pre class="scala"><code style="font-size:1em; min-height:24em;  min-width:40em; border:1px solid white;">
</code></pre>
</section>

<section data-id="">
  <h2>Kafka Spark Cassandra</h2>
<pre class="scala"><code style="font-size:1em; min-height:24em;  min-width:40em; border:1px solid white;">
</code></pre>
</section>

<section data-id="">
  <h2>Grand Finale</h2>
<pre class="scala"><code style="font-size:1em; min-height:24em;  min-width:40em; border:1px solid white;">
</code></pre>
</section>


<section data-id="ScalaDBReferences">
  <h2>References</h2>
  <ul style="margin-left:0.6em; font-size:26px;">
      <li><div class="width340">Big Data Driving Business</div><a href="http://www.ted.com/talks/philip_evans_how_data_will_transform_business">http://bit.ly/194auY9</a></li>
      <li><div class="width340">REST API Tutorial</div><a href="http://www.restapitutorial.com/resources.html">http://www.restapitutorial.com/resources.html</a></li>
      <li><div class="width340">CAP Theorem</div><a href="http://en.wikipedia.org/wiki/CAP_theorem">http://en.wikipedia.org/wiki/CAP_theorem</a></li>
      <li><div class="width340">Grid Gain</div><a href="http://www.gridgain.com/">http://www.gridgain.com/</a></li>
      <li><div class="width340">Apache Spark</div><a href="https://spark.apache.org/">https://spark.apache.org/</a></li>
      <li><div class="width340">The Reactive Manifesto</div><a href="http://www.reactivemanifesto.org/">www.reactivemanifesto.org/</a></li>
      <li><div class="width340">These slides in PDF</div><a href="https://speakerdeck.com/axiom6">https://speakerdeck.com/axiom6</a></li>
  </ul>
</section>

<section data-id="ScalaDBTheEnd">
    <h1>THE END</h1>
</section>

</div>
</div>

</body>
</html>
